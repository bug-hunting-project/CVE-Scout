import pymongo

class db_parse:
        def parser(get_uuid):
            # conn_default = pymongo.MongoClient()
            server_ip = ""
            connection = pymongo.MongoClient('192.168.72.158', 27017)
            cursor = connection["CVE-Scout"]
            cve_data = (cursor[get_uuid].find())

            result = []
            for i in cve_data:
                # print(i.keys())
                # print(type(i))
                for j in i["matches"]:
                    if len((j['relatedVulnerabilities'])) != 0:
                        tmp = []
                        # print(j['relatedVulnerabilities'])
                        for k in (j['relatedVulnerabilities']):
                            cve_id = (k['id'])
                            # print(cve_id)
                            cve_detail = (k['description'])
                            tmp.append(cve_id)
                            tmp.append(cve_detail)
                            # print()
                            if k["namespace"] == "nvd:cpe":
                                cve_cvss = (k['cvss'][-1]['vector'])
                                tmp.append(cve_cvss)
                        result.append(tmp)
            return result